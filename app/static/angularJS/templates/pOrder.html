<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-xs-12">
        <div class="col-sm-12">
            <h2>Ordenes</h2>
        </div>
        <div class="col-sm-12">
            <div class="col-sm-1 hidden-xs">
                <div class="form-group">
                        <label for="pOrder.nOrder">Proveedor:</label>                    
                </div>      
            </div>
            <div class="col-sm-2 hidden-xs">    
                <div class="form-group">                    
                        <input type="text" class="form-control" ng-model="proveedor.RFC" disabled>                                                    
                </div>      
            </div>
            <div class="col-sm-2 hidden-xs">    
                <div class="form-group">
                        <button type="button" class="btn btn-info" data-toggle="modal" data-target="#searchProveedor">Buscar Proveedor</button>
                </div>
            </div>
            <div class="col-sm-3 hidden-xs">    
                <div class="form-group">
                        <span>{{proveedor.Nombre}}</span>
                </div>            
            </div>    
        </div> 
        <div class="col-sm-12">
            <div class="col-sm-2 hidden-xs">
                            <div class="form-group">                                
                                <label for="pOrder.nOrder">Empresa </label>
                                <!--select ng-model="company" class="form-control" ng-change="changeCompany(company)" ng-options="o.emp_nombre for o in companyList track by o.emp_idempresa">
                                </select-->
                                <select class="form-control" ng-model="empresaActual" ng-options="empresa.emp_nombre for empresa in companyList track by empresa.emp_idempresa" name="txtEmpresa" ng-change="changeCompany(empresaActual)"">
                                        <option value="">--Seleccione--</option>
                                    </select>
                            </div>
            </div>
            <div class="col-sm-2 hidden-xs">
                            <div class="form-group">
                                <label for="pOrder.nOrder">Sucursal </label>
                                <select ng-model="branchActual" class="form-control" ng-change="changeBranch(branchActual)" ng-options="o.suc_nombre for o in branchList track by o.suc_idsucursal">
                                    <option value="">--Seleccione--</option>
                                </select>
                            </div>
            </div>
            <div class="col-sm-2 hidden-xs">
                            <div class="form-group">
                                <label for="pOrder.nOrder">Departamento</label>
                                <select ng-model="departamentoActual" class="form-control" ng-change="changeDepto(departamentoActual)" ng-options="o.dep_nombre for o in deptosList track by o.dep_iddepartamento">
                                    <option value="">--Seleccione--</option>
                                </select>
                            </div>
            </div>
            <div class="form-group col-sm-2 hidden-xs" id="calendar">
                <label for="fInicio" class="text-main">Fecha Inicio:</label><br>
                    <div class="input-group date">
                        <span class="input-group-addon"></span>
                        <input type="text" class="form-control" id="fInicio" ng-model="fechas.fechaIni">
                    </div>
            </div>
            <div class="form-group col-sm-2 hidden-xs" id="calendar">
                <label for="fInicio" class="text-main">Fecha Fin:</label><br>
                    <div class="input-group date">
                        <span class="input-group-addon"><!--i class="glyphicon glyphicon-calendar"></i--></span>
                        <input type="text" class="form-control" id="fFin" ng-model="fechas.fechaFin">
                    </div>
            </div>
            <div class="col-sm-1 hidden-xs">                
                <div style="padding-top: 5px;"">
                    <br> 
                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#modalPop" ng-click="search()">Buscar </button>
                </div>
            </div>    
        </div>
    </div>
    <div class="col-xs-12">
        <div class="row nav-orders">
            <div class="col-sm-4">
                <button ui-sref="admin.pOrder" class="btn btn-block btn-primary  animated pulse " type="button"><i class="fa fa-clock-o"></i>
                    <br>Pendientes</button>
            </div>
            <div class="col-sm-4">
                <button ui-sref="admin.iPortal" class="btn btn-block btn-primary btn-outline " type="button"><i class="fa fa-folder-open-o"></i>
                    <br>Ingresadas</button>
            </div>
            <div class="col-sm-4">
                <button ui-sref="admin.oPaid" class="btn btn-block btn-primary btn-outline " type="button"><i class="fa fa-usd"></i>
                    <br>Pagadas</button>
            </div>
        </div>
    </div>
</div>
<div class="wrapper wrapper-content">
    <div ng-show="visible" class="text-center animated fadeInRight">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-sm-4">
                            <div class="form-group has-feedback">
                                <label for="pOrder.nOrder">Búsqueda </label>
                                
                                <i class=""></i>
                            </div>
                        </div>
                        <div class="col-sm-4 hidden-xs">
                            <div class="form-group">
                                <label for="pOrder.nOrder"> </label>
                                  
                                  <!--select ng-model="company" class="form-control" ng-change="changeCompany(company)" ng-options="o.emp_nombre for o in companyList track by o.emp_idempresa"-->
                                </select>
                            </div>
                        </div>
                        <div class="col-sm-4 hidden-xs">
                            <div class="form-group">
                                <!--label for="pOrder.nOrder">Sucursal</label>
                                <select ng-disabled="!branchSelectVisible" ng-model="branch" class="form-control" ng-change="changeBranch(branch)" ng-options="o.suc_nombre for o in branchList track by o.suc_idsucursal">
                                </select-->
                            </div>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table  table-bordered table-condensed ">
                            <thead>
                                <tr>
                                    <th>
                                        <button ng-click="changeOrderName()" ng-class="{'fa-sort': orderName=='','fa-sort-asc': orderName=='asc','fa-sort-desc': orderName=='desc'}" class="btn btn-xs fa pull-right" type="button" name="button"></button>
                                        Orden de compra
                                        <!--input ng-change="changeOrder()" ng-model="order" class="form-control" id="pOrder.nOrder"-->
                                        <input ng-model="order.oce_folioorden" class="form-control">
                                        
                                      </th>
                                    <th>
                                      <button ng-click="changeOrderDetail()" ng-class="{'fa-sort': orderDetail=='','fa-sort-asc': orderDetail=='asc','fa-sort-desc': orderDetail=='desc'}" class="btn btn-xs fa pull-right" type="button" name="button"></button>
                                      Detalle
                                      <input ng-model="order.emp_nombre" class="form-control">
                                      <!--input ng-model="detalleOrdenFiltro" ng-change="filtroDetalle()" class="form-control"-->
                                    </th>
                                    <th>
                                        <button ng-click="changeOrderDate()" ng-class="{'fa-sort': orderDate=='','fa-sort-asc': orderDate=='asc','fa-sort-desc': orderDate=='desc'}" class="btn btn-xs fa pull-right" type="button" name="button"></button>
                                        Fecha
                                        <input ng-model="order.oce_fechaorden" class="form-control">
                                    </th>
                                    <th>
                                        <button ng-click="changeOrderImport()" ng-class="{'fa-sort': orderImport=='','fa-sort-asc': orderImport=='asc','fa-sort-desc': orderImport=='desc'}"  class="btn btn-xs fa pull-right" type="button" name="button"></button>                                        
                                        Importe
                                        <input ng-model="order.oce_importetotal" class="form-control">
                                    </th>
                                    <th>Serie<input ng-model="order.NumSerie" class="form-control"></th>
                                    <th>Orden<input ng-model="order.ordenServicio" class="form-control"></th>
                                    <th width="5%">Subir <p> Factura</th
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-class="{'bg-success':order.visto==1}" ng-repeat="order in orderList | company : company
                      | branch:branch | filter : order | offset: currentPage*itemsPerPage | limitTo: itemsPerPage">
                                    <td>
                                        {{order.oce_folioorden}}<br>
                                        {{order.per_rfc}}<br>
                                        <span ng-show="currentUser.ppro_idUserRol == 2">{{order.nombreProveedor}}</span>
                                    </td>
                                    <td>
                                        {{order.emp_nombre}}
                                        <br> {{order.suc_nombre}}
                                        <br> {{order.dep_nombre}}
                                    </td>
                                    <td width="110px">
                                        {{order.oce_fechaorden | date:"dd/MM/yyyy"}}
                                    </td>
                                    <td width="110px" ng-show="order.idEstatusOrden <= 5">
                                        {{order.oce_importetotal | currency}}
                                    </td>
                                    <td width="110px" ng-show="order.idEstatusOrden > 5">
                                        {{order.oce_imptotalrecibido | currency}}
                                    </td>
                                    <td>
                                        {{order.NumSerie}}
                                    </td>
                                    <td> 
                                        {{order.ordenServicio}}  
                                    </td>
                                    <td width="5%">
                                        <button ng-class="{'btn-primary':order.visto==1}" ng-click="uploadinvoice(order)" class="btn btn-default btn-icon btn-xs" data-toggle="modal" data-target="#fileModal" name="button">Subir<!--span class="glyphicon glyphicon-share"   class="btn btn-default btn-icon btn-circle"></span--></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    Pagina {{currentPage+1}} de {{pageCount()+1}}
                    <div class="admin-pagination">
                        <ul class="pagination">
                            <li ng-class="prevPageDisabled()">
                                <a href ng-click="prevPage()"><i class="fa fa-chevron-left"></i></a>
                            </li>
                            <li ng-repeat="n in range()"  ng-click="setPage(n)">
                                <a ng-class="{'navy-bg': n == currentPage}" href="#">{{n+1}}</a>
                            </li>
                            <li ng-class="nextPageDisabled()">
                                <a href ng-click="nextPage()"><i class="fa fa-chevron-right"></i></a>
                            </li>
                        </ul>
                    </div>                    
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="searchProveedor" role="dialog">
                          <div class="modal-dialog">
                            <div class="modal-content">
                              <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title">Búsqueda de proveedores</h4>
                              </div>
                              <div class="modal-body">
                                <div class="input-group searchinResults">
                                  <input type="text" class="form-control" placeholder="Introduzca un nombre o RFC..." ng-model="textProveedor">
                                  <span class="input-group-btn">
                                    <button class="btn btn-primary" type="button" ng-click="BuscarProveedor()">Buscar</button>
                                  </span>
                                </div><!-- /input-group -->
                                <div class="tableContent">
                                  <table class="table table-striped table-condensed table-hover">
                                    <thead>
                                      <tr>
                                        <th>ID</th>
                                        <th>Nombre</th>
                                        <th>RFC</th>
                                        <th>Tipo</th>
                                        <th>Acción</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr ng-repeat="proveedor in listaProveedores">
                                        <td> {{ proveedor.idProveedor }} </td>
                                        <td> {{ proveedor.Nombre }} </td>
                                        <td> {{ proveedor.RFC }} </td>
                                        <td> {{ proveedor.Tipo }} </td>
                                        <td> <button type="button" class="btn btn-default glyphicon glyphicon-hand-left" data-toggle="tooltip" data-placement="top" title="Seleccionar" ng-click="SetProveedor(proveedor);"></button> </td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                              <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Salir</button>
                              </div>
                            </div><!-- /.modal-content -->
                          </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<div class="modal fade" id="modalPop">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Busando... </h4>
            </div>
            <div class="modal-body">
                <div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal fade-->
